<!DOCTYPE html>
<html lang="en">
<head>
  <link rel="icon" type="image/x-icon" href="favicon.ico">
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Vytron App — Parts & Inventory</title>
  <link rel="stylesheet" href="styles.css" />

  <!-- Firebase (expects your firebase-config.js to init firebase, auth, db, storage) -->
  <script src="https://www.gstatic.com/firebasejs/10.12.4/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.4/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.4/firebase-firestore-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.4/firebase-storage-compat.js"></script>
  <script src="firebase-config.js"></script>

  <!-- OCR + Barcode -->
  <script src="https://cdn.jsdelivr.net/npm/tesseract.js@5/dist/tesseract.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@zxing/library@0.20.0/umd/index.min.js"></script>

  <style>
    /* Small additions in case your styles.css doesn’t have these */
    .container{max-width:1000px;margin:0 auto;padding:12px}
    .card{background:#131720;border:1px solid #222;border-radius:12px;padding:12px;margin:12px 0}
    .row{display:flex;gap:10px;align-items:center;flex-wrap:wrap}
    .grid2{display:grid;grid-template-columns:1fr 1fr;gap:10px}
    input,button,textarea,select{background:#0b0e14;border:1px solid #2a2f3a;color:#eaeaea;border-radius:8px;padding:10px;font-size:14px}
    .primary{background:#3556f5;border-color:#3556f5}
    .list{list-style:none;margin:8px 0;padding:0;display:flex;flex-direction:column;gap:8px}
    .list li{padding:10px;border:1px solid #262b38;border-radius:8px;background:#0c111a}
    .help{font-size:12px;color:#aab}
    #preview{width:100%;max-height:300px;background:#000;border-radius:8px}
    .hide{display:none}
    header{padding:10px 12px;border-bottom:1px solid #222;background:#12141a}
    header nav a{color:#d7d7d7;margin-right:12px;text-decoration:none}
    header nav a.active{font-weight:600}
  </style>
</head>
<body>
<header>
  <nav>
    <a href="index.html">Home</a>
    <a href="equip.html">Equipment</a>
    <a class="active" href="inventory.html">Parts & Inventory</a>
    <a href="pm.html">PM</a>
    <a href="repairs.html">Repairs</a>
  </nav>
</header>

<main class="container">
  <h1>Parts & Inventory</h1>

  <section class="card">
    <h2>Add / Receive Part</h2>
    <div class="row">
      <button id="startScanner">Live Barcode Scan</button>
      <input id="p_labelPhoto" type="file" accept="image/*" capture="environment">
      <button id="p_runOCR">OCR Label</button>
      <label style="display:inline-flex;gap:8px;align-items:center;margin-left:8px;">
        <input type="checkbox" id="autoAddNew" checked> Auto-create new part from photo/scan
      </label>
    </div>
    <video id="preview" playsinline class="hide"></video>

    <div class="grid2" style="margin-top:10px">
      <label>Part # <input id="p_partNo" placeholder="6203 / 4825U011 / DFS25A-..."></label>
      <label>Description <input id="p_desc" placeholder="Heater band 2&quot; 120V / Bearing 6203..."></label>
      <label>On Hand <input id="p_qty" type="number" min="0" step="1" value="0"></label>
      <label>Min Qty <input id="p_min" type="number" min="0" step="1" value="0"></label>
      <label>Bin/Nickname <input id="p_bin" placeholder="E4-DrawerA"></label>
      <label>Vendor <input id="p_vendor" placeholder="McMaster / Grainger / ..."></label>
    </div>
    <div class="row">
      <button id="savePart" class="primary">Save / Update Part</button>
    </div>
  </section>

  <section class="card">
    <h2>Inventory</h2>
    <div class="row">
      <input id="partsSearch" placeholder="Search part # or description..." style="flex:1;min-width:240px">
      <button id="exportPartsCsv">Export Parts CSV</button>
      <button id="exportRepairsCsv">Export Repairs CSV</button>
      <span id="lowStockCount" class="help"></span>
    </div>
    <ul id="partsList" class="list"></ul>
  </section>
</main>

<script src="inventory.js"></script>
<script>
  if ('serviceWorker' in navigator) {
    window.addEventListener('load', ()=>navigator.serviceWorker.register('sw.js').catch(()=>{}));
  }
</script>
</body>
</html>
